<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Rock Paper Scissors</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="row">
          <h1 class="text-center">Rock Paper Scissors</h1>
          <hr/>
      </div>

      <div id="gamePlay">
        <!-- GAME LOADS HERE -->
      </div>
    </div>

    <div id="toBeInitiated" style="display: none;">
      <h2 class="intro-text">Please initiate a game by choosing your move</h2>
      <center>
        <button class="btn btn-default btn-move btn-rock" type="button" data-id="0">
          Rock
        </button>
        <button class="btn btn-default btn-move btn-paper" type="button" data-id="1">
          Paper
        </button>
        <button class="btn btn-default btn-move btn-scissors" type="button" data-id="2">
          Scissors
        </button>
      </center>
      <h4 class="explain-text">Please also choose a secret password to protect your move:</h4>
      <form>
      <div class="row">
        <div class="col-lg-4"></div>
        <div class="form-group col-xs-5 col-lg-4 col-centered">
          <center><input type="text" class="form-control in-pwd" id="password" placeholder="Password"/></center>
        </div>
      </div>
      <center>
        <button class="btn btn-primary btn-init" type="button" disabled="true">
          Initiate a game!
        </button>
        <br><small id="initHelp" class="form-text text-muted">(0.05 ETH bid + 0.01 ETH commitment fee)</small>
      </center><br>
      <span>
        Your move is encrypted with your secret password. You are the only one to know your move and your password, so remember both! You will have to <u>commit to it</u>.<br>You will be able to get your funds back until someone challenges you. Once a challenger has played his move, you will have 24 hours to <i>reveal</i> yours by re-submitting it, with your password. It should match your initial input, or you will lose all your funds (0.06 ETH). If you commit to your initial input:
        <ul>
          <li> You will retrieve your commitment fee (0.01 ETH) ;</li>
          <li> The smart contract will send 0.1 ETH to the winner, or 0.05 ETH to each player in case of a tie.</li>
        </ul>
        After someone has challenged you, you should reveal your move within the next 24 hours. After that deadline, the challenger will be able to retrieve all the funds at stake (0.11 ETH), and you will lose your commitment fee and bid.
      </span>
    </div>


    <div id="toBeChallenged" style="display: none;">
      <h2 class="intro-text">Please choose your move to challenge a hidden initiator</h2>
      <center>
        <button class="btn btn-default btn-move btn-rock" type="button" data-id="0">
          Rock
        </button>
        <button class="btn btn-default btn-move btn-paper" type="button" data-id="1">
          Paper
        </button>
        <button class="btn btn-default btn-move btn-scissors" type="button" data-id="2">
          Scissors
        </button>
      </center>
      <br>
      <center>
        <button class="btn btn-primary btn-challenge" type="button" disabled="true">
          Challenge the initiator of the game!
        </button>
        <br><small id="initHelp" class="form-text text-muted">(0.05 ETH bid)</small>
      </center><br>
      <span>
        An initiator has already played his move, and you are playing against him, or <i>challenging</i> him. After your challenge, he will have 24 hours to <i>reveal</i> his move. Indeed, he is commited to a move, but for security purpose his move is encrypted. However, be assured that he cannot change his plans according to yours, or you will be the declared winner. Upon his revelation, the smart contract will send 0.1 ETH to the winner, or 0.05 ETH to each player in case of a tie.
        <br>If the initiator tries to cheat by changing his move, and does not stick to his commitment, you will receive 0.11 ETH (your 0.05 bid, his, and his 0.01 ETH commitment incentive).
        <br>Also note that 24 hours after your challenge, if the initiator has not revealed his move, you will be able to claim these 0.11 ETH.
      </span>
    </div>

    <div id="waitingForChallenger" style="display: none;">
      <h2 class="intro-text">Waiting for a challenger</h2>
      <span>
      Your move has successfully been encrypted and stored. You should now wait for a challenger to play against you. Once challenged, you will have 24 hours to reveal your move, by submitting it again with your password. After that deadline, your challenger will be able to redeem your funds. Additionnally, if you try to cheat by not sticking to your original move, your funds will be sent to the challenger.
      <br><br>
      Tired of waiting for a challenger? Anxious about not remembering your move and password? You are also able to delete this game you have initiated:
      </span>
      <center>
      <button class="btn btn-primary btn-destroy" type="button">
        Delete this game!
      </button>
      <br><small id="destroyHelp" class="form-text text-muted">(you will receive your 0.06 ETH back)</small>
      </center>
    </div>

    <div id="toBeRevealed" style="display: none;">
      <h2 class="intro-text">You should now reveal your move</h2>
      <center>
        <button class="btn btn-default btn-move btn-rock" type="button" data-id="0">
          Rock
        </button>
        <button class="btn btn-default btn-move btn-paper" type="button" data-id="1">
          Paper
        </button>
        <button class="btn btn-default btn-move btn-scissors" type="button" data-id="2">
          Scissors
        </button>
      </center>
      <h4 class="explain-text">Please also enter your secret password you used to protect your move:</h4>
      <form>
      <div class="row">
        <div class="col-lg-4"></div>
        <div class="form-group col-xs-5 col-lg-4 col-centered">
          <center><input type="text" class="form-control in-pwd" id="password" placeholder="Password"/></center>
        </div>
      </div>
      <center>
        <button class="btn btn-primary btn-reveal" type="button" disabled="true">
          Reveal my move!
        </button>
        <br><small id="initHelp" class="form-text text-muted">(free)</small>
      </center><br>
      <span>
        Your move has been encrypted with your secret password. You are the only one to know your move and your password for now!
        A challenger has played against you, and you have 24 hours from the moment he played to reveal your move by re-submitting it, with your password. It should match your initial input, or you will lose all your funds (0.06 ETH). If you commit to your initial input:
        <ul>
          <li> You will retrieve your commitment fee (0.01 ETH) ;</li>
          <li> The smart contract will send 0.1 ETH to the winner, or 0.05 ETH to each player in case of a tie.</li>
        </ul>
      </span>
    </div>

    <div id="waitingForRevelation" style="display: none;">
      <h2 class="intro-text">Waiting for the initiator to reveal its move</h2>
      <span>
        The move of a challenger has successfully been registered. He should now wait for the initiator of the game to reveal his.
        <br>Note that 24 hours after your challenge, if the initiator still has not revealed his move, the challenger will be able to redeem all the contract's funds (0.11 ETH).
        <br>You cannot play the game until one of the above happens.
      </span>
    </div>

    <div id="challengerWaitingForRevelation" style="display: none;">
      <h2 class="intro-text">Waiting for the initiator to reveal its move</h2>
      <span>
        Your move has successfully been registered. You should now wait for the initiator of the game to reveal his.
        <br>Note that 24 hours after your challenge, if the initiator still has not revealed his move, you will be able to redeem all the contract's funds (0.11 ETH).
      </span>
    </div>

    <div id="challengerWaitingForRevelationOrRedeem" style="display: none;">
      <h2 class="intro-text">Waiting for the initiator to reveal its move</h2>
      <span>
        Your move has successfully been registered. You should now wait for the initiator of the game to reveal his.
        <br>Since the initiator has not revealed his move in 24 hours, you can now redeem all the contract's funds if you wish to.<br><br>
      </span>
      <center>
      <button class="btn btn-primary btn-redeem" type="button">
        Delete this game!
      </button>
      <br><small id="redeemHelp" class="form-text text-muted">(you will receive your 0.11 ETH back)</small>
      </center>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <script src="js/web3.min.js"></script>
    <script src="js/truffle-contract.js"></script>
    <script src="js/sha3.min.js"></script>
    <script src="js/app.js"></script>
  </body>
</html>
